"use strict";function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var _createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),environment=function(){function n(){_classCallCheck(this,n)}return _createClass(n,[{key:"initialize",value:function(){var i=this,r,n,u,t,f;this.loadState();r=document.querySelector("#devExplorerToolbar .btn-group");n=document.createElement("button");n.className="btn btn-sm btn-light";n.setAttribute("title","Copy component");n.addEventListener("click",function(){i.copyComponent()});u=document.createElement("i");u.className="fal fa-copy";n.appendChild(u);r.appendChild(n);this.copyButton=n;t=document.createElement("button");t.className="btn btn-sm btn-light";t.setAttribute("title","Paste component");t.addEventListener("click",function(){i.pasteComponent()});f=document.createElement("i");f.className="fal fa-paste";t.appendChild(f);r.appendChild(t);this.pasteButton=t;ide.element[0].addEventListener("selectionChanged",function(){i.syncButtons()});this.syncButtons()}},{key:"copyComponent",value:function(){if(this.isComponentSelected){var n=document.querySelector(".dev-explorer-node-content.active").parentElement.getAttribute("data-id"),t={component:n};this.updateState(t)}}},{key:"pasteComponent",value:function(){var n=document.querySelector(".dev-explorer-node-content.active"),i=n.parentElement.getAttribute("data-container"),t=null;i==="true"&&n.parentElement.getAttribute("data-static")!=="true"&&(t=n.parentElement.getAttribute("data-id"));ide.ideAction({data:{action:"clone",component:this.state.component,folder:t},onComplete:function(){var n=ide._resolvePath(ide.selectedElement());ide.refreshSections({sections:"explorer",path:n});tompit.success("Component pasted from the clipboard.","Paste component")}})}},{key:"syncButtons",value:function(){this.copyButton.disabled=!this.isComponentSelected;this.pasteButton.disabled=!this.clipboardComponent||this.isComponentSelected}},{key:"loadState",value:function(){var n=this,t=tompit.DEVDEFAULTS.rootUrl+"/sys/select-user-state";this._state=tompit.post({contentType:"application/json; charset=utf-8",dataType:"json",data:{primaryKey:"env",topic:"state"},url:t,onSuccess:function(t){n.state=t;n.syncButtons()}})}},{key:"updateState",value:function(n){this.state=n;var t=tompit.DEVDEFAULTS.rootUrl+"/sys/update-user-state";tompit.post({contentType:"application/json; charset=utf-8",dataType:"json",data:{primaryKey:"env",topic:"state",value:n},url:t,onSuccess:function(){tompit.success("Component copied to the clipboard.","Copy component")}})}},{key:"clipboardComponent",get:function(){return this.state?this.state.component:null}},{key:"isFolderSelected",get:function(){var n=document.querySelector(".dev-explorer-node-content.active"),t;return n?(t=n.parentElement.getAttribute("data-container"),t==="true"):!1}},{key:"isComponentSelected",get:function(){var n,t;return this.isFolderSelected?!1:(n=document.querySelector(".dev-explorer-node-content.active"),!n)?!1:(t=n.parentElement.getAttribute("data-static"),t==="false")}},{key:"copyButton",get:function(){return this._copyButton},set:function(n){this._copyButton=n}},{key:"pasteButton",get:function(){return this._pasteButton},set:function(n){this._pasteButton=n}},{key:"state",get:function(){return this._state},set:function(n){this._state=n}}]),n}();window.env=window.env||new environment;